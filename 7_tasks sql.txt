--1. Вывести записи с таблицы UserLog, для которых ActionCode может иметь значения '201', '401', '524'.

Select *
  From UserLog u
 Where u.ActionCode IN ('201','401','524')
    Go

--2. Вывести пользователей с таблицы Customer, которые родились до даты 1978-05-15 (включительно) и страна 804.

Select *
  From Customer c
 Where c.Birthday <= '1978-05-15'
   And c.Country = '804'
    Go


--3. Найти пользователей с таблицы Customer и UserLog, у которых код страны не равен 804 и ActionCode начинается на 2. 
--Вывести на эран следующие поля: CustomerLogin, NameUser, Country, Resident, DateTime, ActionCode, ActionDescription
--Обязательно использовать алиасы

Select c.CustomerLogin, c.NameUser, c.Country, c.Resident, u.DateTime, u.ActionCode, u.ActionDescription
  From Customer c INNER JOIN UserLog u  ON  c.Cust_Id = u.IdCust
 Where c.Country <> '804'
   And u.ActionCode LIKE '2%'
    Go
  
  
  --4. Вывести пользователей с таблицы Customer, для которых нет записей о логировании в таблице UserLog

Select *
  From Customer c LEFT JOIN UserLog u  ON  c.Cust_Id = u.IdCust
 Where u.Id is null
    Go


--5. Вывести клиентов с таблицы Customer и Penalty, которые родились раньше даты 1985-04-14 (не включительно) или у них не было штрафа.
--Данные отсортировать по CustomerLogin в возрастающием порядке, а штрафы по дате в обратном порядке.   


  Select * 
    From Customer c LEFT JOIN Penalty p ON c.Cust_Id = p.CustomerId
   Where c.Birthday < '1985-04-14' 
         or p.Id is null
Order by c.CustomerLogin, p.[Date] desc
      Go



--6. Вывести список групп, которые связаны с курсами (данные искать в  таблицах UserGroup и Course, проанализировать связь между ними и связать).
--Вывести на экран Name, CourseId, Code, Title, Description	

 Select u.Name, u.CourseId, c.Code, c.Title, c.Description 
   From UserGroup u INNER JOIN Course c ON u.CourseId = c.CourseId
     Go



--7. Вывести только те записи о людях, которые имеют роль 'Студент'. Проанализировать таблицы UserData, UserRoleLink, UserRole и связи между ними.
--Выборка будет состоять из связи 3-х таблиц и одного условия по роли.
--На экран вывести колонки login, LastName, FirstName, MiddleName, Name

Select u.Login, u.LastName, u.FirstName, u.MiddleName, r.Name
  From Userdata u INNER JOIN UserRoleLink l ON u.UserDataId = l.UserDataId
                  INNER JOIN UserRole r ON r.UserRoleId = l.UserRoleId
 Where r.[Name] = 'Студент' 
    Go